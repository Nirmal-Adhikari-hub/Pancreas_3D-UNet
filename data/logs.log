Using 3 GPUs on cudaUsing 3 GPUs on cuda

World Size: 1 
 Local Rank: 0World Size: 1 
 Local Rank: 0

Number of patches: 2, 
 Number of Labels: 2Number of patches: 2, 
 Number of Labels: 2

/shared/home/xvoice/nirmal/project/Unet_seg/Pancreas_3D-UNet/data/dataloader.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  aug_patch_tensor = torch.tensor(aug_patch)
/shared/home/xvoice/nirmal/project/Unet_seg/Pancreas_3D-UNet/data/dataloader.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  aug_patch_tensor = torch.tensor(aug_patch)
/shared/home/xvoice/nirmal/project/Unet_seg/Pancreas_3D-UNet/data/dataloader.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  aug_patch_tensor = torch.tensor(aug_patch)
After Augmentation: 
 Patches - torch.Size([4, 32, 512, 512]), Labels -> torch.Size([4, 32, 512, 512])After Augmentation: 
 Patches - torch.Size([4, 32, 512, 512]), Labels -> torch.Size([4, 32, 512, 512])

Number of patches: 5, 
 Number of Labels: 5Number of patches: 5, 
 Number of Labels: 5

/shared/home/xvoice/nirmal/project/Unet_seg/Pancreas_3D-UNet/data/dataloader.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  aug_patch_tensor = torch.tensor(aug_patch)
/shared/home/xvoice/nirmal/project/Unet_seg/Pancreas_3D-UNet/data/dataloader.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  aug_patch_tensor = torch.tensor(aug_patch)
/shared/home/xvoice/nirmal/project/Unet_seg/Pancreas_3D-UNet/data/dataloader.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  aug_patch_tensor = torch.tensor(aug_patch)
Number of patches: 6, 
 Number of Labels: 6Number of patches: 6, 
 Number of Labels: 6

Number of patches: 6, 
 Number of Labels: 6Number of patches: 6, 
 Number of Labels: 6

/shared/home/xvoice/nirmal/project/Unet_seg/Pancreas_3D-UNet/data/dataloader.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  aug_patch_tensor = torch.tensor(aug_patch)
/shared/home/xvoice/nirmal/project/Unet_seg/Pancreas_3D-UNet/data/dataloader.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  aug_patch_tensor = torch.tensor(aug_patch)
/shared/home/xvoice/nirmal/project/Unet_seg/Pancreas_3D-UNet/data/dataloader.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  aug_patch_tensor = torch.tensor(aug_patch)
/shared/home/xvoice/nirmal/project/Unet_seg/Pancreas_3D-UNet/data/dataloader.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  aug_patch_tensor = torch.tensor(aug_patch)
/shared/home/xvoice/nirmal/project/Unet_seg/Pancreas_3D-UNet/data/dataloader.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  aug_patch_tensor = torch.tensor(aug_patch)
/shared/home/xvoice/nirmal/project/Unet_seg/Pancreas_3D-UNet/data/dataloader.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  aug_patch_tensor = torch.tensor(aug_patch)
After Augmentation: 
 Patches - torch.Size([10, 32, 512, 512]), Labels -> torch.Size([10, 32, 512, 512])After Augmentation: 
 Patches - torch.Size([10, 32, 512, 512]), Labels -> torch.Size([10, 32, 512, 512])

After Augmentation: 
 Patches - torch.Size([12, 32, 512, 512]), Labels -> torch.Size([12, 32, 512, 512])After Augmentation: 
 Patches - torch.Size([12, 32, 512, 512]), Labels -> torch.Size([12, 32, 512, 512])

After Augmentation: 
 Patches - torch.Size([12, 32, 512, 512]), Labels -> torch.Size([12, 32, 512, 512])After Augmentation: 
 Patches - torch.Size([12, 32, 512, 512]), Labels -> torch.Size([12, 32, 512, 512])

Number of patches: 8, 
 Number of Labels: 8Number of patches: 8, 
 Number of Labels: 8

Number of patches: 4, 
 Number of Labels: 4Number of patches: 4, 
 Number of Labels: 4

Number of patches: 6, 
 Number of Labels: 6Number of patches: 6, 
 Number of Labels: 6

Number of patches: 5, 
 Number of Labels: 5Number of patches: 5, 
 Number of Labels: 5

After Augmentation: 
 Patches - torch.Size([16, 32, 512, 512]), Labels -> torch.Size([16, 32, 512, 512])After Augmentation: 
 Patches - torch.Size([16, 32, 512, 512]), Labels -> torch.Size([16, 32, 512, 512])

After Augmentation: 
 Patches - torch.Size([8, 32, 512, 512]), Labels -> torch.Size([8, 32, 512, 512])After Augmentation: 
 Patches - torch.Size([8, 32, 512, 512]), Labels -> torch.Size([8, 32, 512, 512])

After Augmentation: 
 Patches - torch.Size([12, 32, 512, 512]), Labels -> torch.Size([12, 32, 512, 512])After Augmentation: 
 Patches - torch.Size([12, 32, 512, 512]), Labels -> torch.Size([12, 32, 512, 512])

After Augmentation: 
 Patches - torch.Size([10, 32, 512, 512]), Labels -> torch.Size([10, 32, 512, 512])After Augmentation: 
 Patches - torch.Size([10, 32, 512, 512]), Labels -> torch.Size([10, 32, 512, 512])

Number of patches: 4, 
 Number of Labels: 4Number of patches: 4, 
 Number of Labels: 4

Number of patches: 5, 
 Number of Labels: 5Number of patches: 5, 
 Number of Labels: 5

Number of patches: 5, 
 Number of Labels: 5Number of patches: 5, 
 Number of Labels: 5

After Augmentation: 
 Patches - torch.Size([8, 32, 512, 512]), Labels -> torch.Size([8, 32, 512, 512])After Augmentation: 
 Patches - torch.Size([8, 32, 512, 512]), Labels -> torch.Size([8, 32, 512, 512])

After Augmentation: 
 Patches - torch.Size([10, 32, 512, 512]), Labels -> torch.Size([10, 32, 512, 512])After Augmentation: 
 Patches - torch.Size([10, 32, 512, 512]), Labels -> torch.Size([10, 32, 512, 512])

Number of patches: 6, 
 Number of Labels: 6Number of patches: 6, 
 Number of Labels: 6

After Augmentation: 
 Patches - torch.Size([10, 32, 512, 512]), Labels -> torch.Size([10, 32, 512, 512])After Augmentation: 
 Patches - torch.Size([10, 32, 512, 512]), Labels -> torch.Size([10, 32, 512, 512])

After Augmentation: 
 Patches - torch.Size([12, 32, 512, 512]), Labels -> torch.Size([12, 32, 512, 512])After Augmentation: 
 Patches - torch.Size([12, 32, 512, 512]), Labels -> torch.Size([12, 32, 512, 512])

Number of patches: 2, 
 Number of Labels: 2Number of patches: 2, 
 Number of Labels: 2

Number of patches: 5, 
 Number of Labels: 5Number of patches: 5, 
 Number of Labels: 5

After Augmentation: 
 Patches - torch.Size([4, 32, 512, 512]), Labels -> torch.Size([4, 32, 512, 512])After Augmentation: 
 Patches - torch.Size([4, 32, 512, 512]), Labels -> torch.Size([4, 32, 512, 512])

Number of patches: 6, 
 Number of Labels: 6Number of patches: 6, 
 Number of Labels: 6

After Augmentation: 
 Patches - torch.Size([10, 32, 512, 512]), Labels -> torch.Size([10, 32, 512, 512])After Augmentation: 
 Patches - torch.Size([10, 32, 512, 512]), Labels -> torch.Size([10, 32, 512, 512])

After Augmentation: 
 Patches - torch.Size([12, 32, 512, 512]), Labels -> torch.Size([12, 32, 512, 512])After Augmentation: 
 Patches - torch.Size([12, 32, 512, 512]), Labels -> torch.Size([12, 32, 512, 512])

Number of patches: 5, 
 Number of Labels: 5Number of patches: 5, 
 Number of Labels: 5

Traceback (most recent call last):
Traceback (most recent call last):
Traceback (most recent call last):
  File "/shared/home/xvoice/nirmal/project/Unet_seg/Pancreas_3D-UNet/data/dataloader.py", line 194, in <module>
  File "/shared/home/xvoice/nirmal/project/Unet_seg/Pancreas_3D-UNet/data/dataloader.py", line 194, in <module>
  File "/shared/home/xvoice/nirmal/project/Unet_seg/Pancreas_3D-UNet/data/dataloader.py", line 194, in <module>
            for batch_data, batch_labels in train_loader:for batch_data, batch_labels in train_loader:for batch_data, batch_labels in train_loader:


                                                                                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^


  File "/shared/home/xvoice/anaconda3/envs/transformer_mm/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 630, in __next__
  File "/shared/home/xvoice/anaconda3/envs/transformer_mm/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 630, in __next__
  File "/shared/home/xvoice/anaconda3/envs/transformer_mm/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 630, in __next__
            data = self._next_data()data = self._next_data()data = self._next_data()


                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^


  File "/shared/home/xvoice/anaconda3/envs/transformer_mm/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 1344, in _next_data
  File "/shared/home/xvoice/anaconda3/envs/transformer_mm/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 1344, in _next_data
  File "/shared/home/xvoice/anaconda3/envs/transformer_mm/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 1344, in _next_data
            return self._process_data(data)return self._process_data(data)return self._process_data(data)


                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^


  File "/shared/home/xvoice/anaconda3/envs/transformer_mm/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 1370, in _process_data
  File "/shared/home/xvoice/anaconda3/envs/transformer_mm/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 1370, in _process_data
  File "/shared/home/xvoice/anaconda3/envs/transformer_mm/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 1370, in _process_data
            data.reraise()data.reraise()data.reraise()


  File "/shared/home/xvoice/anaconda3/envs/transformer_mm/lib/python3.12/site-packages/torch/_utils.py", line 706, in reraise
  File "/shared/home/xvoice/anaconda3/envs/transformer_mm/lib/python3.12/site-packages/torch/_utils.py", line 706, in reraise
  File "/shared/home/xvoice/anaconda3/envs/transformer_mm/lib/python3.12/site-packages/torch/_utils.py", line 706, in reraise
            raise exceptionraise exceptionraise exception


RuntimeErrorRuntimeErrorRuntimeError: : : Caught RuntimeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/shared/home/xvoice/anaconda3/envs/transformer_mm/lib/python3.12/site-packages/torch/utils/data/_utils/worker.py", line 309, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
           ^^^^^^^^^^^^^^^^^^^^
  File "/shared/home/xvoice/anaconda3/envs/transformer_mm/lib/python3.12/site-packages/torch/utils/data/_utils/fetch.py", line 55, in fetch
    return self.collate_fn(data)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/shared/home/xvoice/anaconda3/envs/transformer_mm/lib/python3.12/site-packages/torch/utils/data/_utils/collate.py", line 317, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/shared/home/xvoice/anaconda3/envs/transformer_mm/lib/python3.12/site-packages/torch/utils/data/_utils/collate.py", line 174, in collate
    return [collate(samples, collate_fn_map=collate_fn_map) for samples in transposed]  # Backwards compatibility.
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/shared/home/xvoice/anaconda3/envs/transformer_mm/lib/python3.12/site-packages/torch/utils/data/_utils/collate.py", line 142, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/shared/home/xvoice/anaconda3/envs/transformer_mm/lib/python3.12/site-packages/torch/utils/data/_utils/collate.py", line 213, in collate_tensor_fn
    out = elem.new(storage).resize_(len(batch), *list(elem.size()))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to resize storage that is not resizable
Caught RuntimeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/shared/home/xvoice/anaconda3/envs/transformer_mm/lib/python3.12/site-packages/torch/utils/data/_utils/worker.py", line 309, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
           ^^^^^^^^^^^^^^^^^^^^
  File "/shared/home/xvoice/anaconda3/envs/transformer_mm/lib/python3.12/site-packages/torch/utils/data/_utils/fetch.py", line 55, in fetch
    return self.collate_fn(data)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/shared/home/xvoice/anaconda3/envs/transformer_mm/lib/python3.12/site-packages/torch/utils/data/_utils/collate.py", line 317, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/shared/home/xvoice/anaconda3/envs/transformer_mm/lib/python3.12/site-packages/torch/utils/data/_utils/collate.py", line 174, in collate
    return [collate(samples, collate_fn_map=collate_fn_map) for samples in transposed]  # Backwards compatibility.
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/shared/home/xvoice/anaconda3/envs/transformer_mm/lib/python3.12/site-packages/torch/utils/data/_utils/collate.py", line 142, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/shared/home/xvoice/anaconda3/envs/transformer_mm/lib/python3.12/site-packages/torch/utils/data/_utils/collate.py", line 213, in collate_tensor_fn
    out = elem.new(storage).resize_(len(batch), *list(elem.size()))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to resize storage that is not resizable
Caught RuntimeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/shared/home/xvoice/anaconda3/envs/transformer_mm/lib/python3.12/site-packages/torch/utils/data/_utils/worker.py", line 309, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
           ^^^^^^^^^^^^^^^^^^^^
  File "/shared/home/xvoice/anaconda3/envs/transformer_mm/lib/python3.12/site-packages/torch/utils/data/_utils/fetch.py", line 55, in fetch
    return self.collate_fn(data)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/shared/home/xvoice/anaconda3/envs/transformer_mm/lib/python3.12/site-packages/torch/utils/data/_utils/collate.py", line 317, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/shared/home/xvoice/anaconda3/envs/transformer_mm/lib/python3.12/site-packages/torch/utils/data/_utils/collate.py", line 174, in collate
    return [collate(samples, collate_fn_map=collate_fn_map) for samples in transposed]  # Backwards compatibility.
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/shared/home/xvoice/anaconda3/envs/transformer_mm/lib/python3.12/site-packages/torch/utils/data/_utils/collate.py", line 142, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/shared/home/xvoice/anaconda3/envs/transformer_mm/lib/python3.12/site-packages/torch/utils/data/_utils/collate.py", line 213, in collate_tensor_fn
    out = elem.new(storage).resize_(len(batch), *list(elem.size()))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to resize storage that is not resizable



